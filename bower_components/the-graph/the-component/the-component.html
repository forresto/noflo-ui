<link rel="import" href="../the-graph-inports/the-graph-inports.html">
<link rel="import" href="../the-graph-outports/the-graph-outports.html">
<polymer-element name="the-component" attributes="name icon description inports outports" lightdom>
  <template>
    <the-graph-inports>
      <template repeat="{{port in inports}}">
        <the-graph-port name="{{port.name}}" type="{{port.type}}"></the-graph-port> 
      </template>
    </the-graph-inports>
    <the-graph-outports>
      <template repeat="{{port in outports}}">
        <the-graph-port name="{{port.name}}" type="{{port.type}}"></the-graph-port> 
      </template>
    </the-graph-outports>
  </template>
  <script>
  (function () {
    "use strict";

    Polymer('the-component', {
      name: '',
      description: '',
      icon: 'gear',
      inports: [],
      outports: [],
      iconChanged: function () {
        this.fire('icon', this.icon);
      },
      inportsChanged: function () {
        // CAVEAT doesn't fire when one port type changes
        this.inObserver = new ArrayObserver(this.inports, function () {
          this.fire('inports', this.inports);
        }.bind(this));
      },
      outportsChanged: function () {
        // CAVEAT doesn't fire when one port type changes
        this.outObserver = new ArrayObserver(this.outports, function () {
          this.fire('outports', this.outports);
        }.bind(this));
      },
      leftView: function () {
        if (this.inObserver) {
          this.inObserver.close();
        }
        if (this.outObserver) {
          this.outObserver.close();
        }
      }
    });
    
  })();
  </script>
</polymer-element>
